<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>Grouping</title>
  <!-- Icon -->
  <link />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" />
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" />
  <!-- MDB UI KIT -->
  <link rel="stylesheet" href="css/mdb.min.css" />
  <!-- Custom styles -->
  <style></style>
</head>

<body>
  <!--Main Navigation-->
  <header class="mb-3">
    <!-- Navbar-->

    <!-- Navbar -->
  </header>
  <!--Main Navigation-->

  <!--Main layout-->
  <main>
    <div class="container text-center">
      <p class="fs-1">Grouping</p>
      <!-- Table -->
      <table class="table">
        <thead class="table-dark" id="table-head"></thead>
        <tbody id="table-body"></tbody>
      </table>
      <!-- Table -->
    </div>
    <section class="content-section" id="about">
      <div class="container px-4 px-lg-5 text-center">
        <p class="fs-6 mt-5">*If you can't see it, wait about a minute and refresh or click <a href="EasyData-EN.html">here</a></p>
        <div class="row gx-4 gx-lg-5 justify-content-center">
          <div class="col-lg-10" id="rule">
            <a class="btn btn-dark btn-xl mb-5" href="index-EN.html#about">Back</a>
          </div>
        </div>
      </div>
    </section>
    <br />
    <br />
  </main>
  <!--Main layout-->

  <!--Footer-->
  <footer></footer>
  <!--Footer-->
</body>
<script type="text/javascript">
  (function($) {

    $(function() {

      // REMOVE THIS LINE once its working
      if (!$.fn.highlight) {
        alert("Hightlight Plugin NOT LOADED!");
      }


      var classNames = "ms-status-yellow s4-status-s3 highlight",
        currentKeyword = '',
        $container = $("#s4-workspace"), // This selector assumes SP2010/2013. Use "body" if on SP2007
        highlight = function() {

          var findText = $("#userFindInputText").val();

          if (!findText) {

            alert("Enter a search value");
            return this;

          }

          // Unhighlight any previous keywords
          if (currentKeyword) {

            $container.unhighlight({
              className: "highlight"
            });
          }

          currentKeyword = findText;
          $container.highlight(findText, {
            className: classNames
          });
          return this;
        };

      $("#userFindInputText").on("keyup", function(ev) {
        if (ev.which === 13) {

          highlight.apply(this, arguments);

        }
      });

      $("#userFindInputButton").on("click", highlight)

    });

  })(jQuery);
</script>

<!-- MDB ESSENTIAL -->
<script type="text/javascript" src="js/mdb.min.js"></script>
<!-- Google API -->
<script src="https://apis.google.com/js/api.js"></script>
<!-- easyData -->
<script type="text/javascript" src="js/easyData-google-sheets.js"></script>

<!-- easyData - Creating table -->
<script>
  {
    {
      // Your API KEY
      const API_KEY = "AIzaSyCFaXb8h4zCPiynX7d5Eala4MP2gn9jLEc";

      function displayResult2(response) {
        let tableHead = "";
        let tableBody = "";

        response.result.values.forEach((row, index) => {
          if (index === 0) {
            tableHead += "<tr>";
            row.forEach((val) => (tableHead += "<th>" + val + "</th>"));
            tableHead += "</tr>";
          } else {
            tableBody += "<tr>";
            row.forEach((val) => (tableBody += "<td>" + val + "</td>"));
            tableBody += "</tr>";
          }
        });

        document.getElementById("table-head").innerHTML = tableHead;
        document.getElementById("table-body").innerHTML = tableBody;
      }

      function loadData() {
        // Spreadsheet ID
        const spreadsheetId = "1-AUvKiKVWBTWcAooNbVroL0nZ-SiuPtGAYfUBN94c7o";
        const range = "A:Z";
        getPublicValues({
          spreadsheetId,
          range
        }, displayResult2);
      }

      window.addEventListener("load", (e) => {
        initOAuthClient({
          apiKey: API_KEY
        });
      });

      document.addEventListener("gapi-loaded", (e) => {
        loadData();
      });
    }
  }
</script>

</html>
